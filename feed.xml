<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Polemic</title>
        <description></description>      
        <link>http://polemic.nz</link>
        <atom:link href="http://polemic.nz/feed.xml" rel="self" type="application/rss+xml" />
        
            <item>
                <title>World Hexes</title>
                <description>&lt;p&gt;Last hex map for a while, I promise! Strapped for time this week so I was lazy and
used the same method as the &lt;a href=&quot;/2015/02/20/nz-population-hexbin/&quot;&gt;previous map&lt;/a&gt;. This map uses a world country boundaries in a
decimal degrees projection (WSG84) with 2.5 degree edge (5 degree span) hexes.&lt;/p&gt;

&lt;p&gt;Creating the border effect in QGIS is straight-forward once you understand
how &amp;quot;symbol levels&amp;quot; work. The symbology for the layer is quite simple - a polygon fill
with a series of border outlines like so:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/20150227-symbology.png&quot; alt=&quot;World Hex Symbology in QGIS&quot;&gt;&lt;/p&gt;

&lt;p&gt;By default, the full symbology for each feature will be drawn one by one, including
any overlaps. The end result looks like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/20150227-bad-map.png&quot; alt=&quot;World Hex Symbology without Symbol Levels&quot;&gt;&lt;/p&gt;

&lt;p&gt;You can change how QGIS draws feature symbology to instead draw each symbol
&amp;#39;level&amp;#39; for all features in sequence. From the &amp;quot;Advanced&amp;quot; menu in the symbology dialog,
click &amp;quot;Symbol Levels&amp;quot; and tick the check-box &amp;quot;Enable symbol levels&amp;quot;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/20150227-symbol-levels.png&quot; alt=&quot;Enabling Symbol Levels in QGIS&quot;&gt;&lt;/p&gt;

&lt;p&gt;This is great for outlining related features, especially when you also stack categorised
symbolizers based on feature attributes, like in my previous &lt;a href=&quot;/2015/01/16/auckland-employment-centres/&quot;&gt;employment centers&lt;/a&gt; map.&lt;/p&gt;
</description>
                <pubDate>Fri, 27 Feb 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/02/27/world-hexes/</link>
                
                <enclosure url="http://polemic.nz/assets/maps/20150227-HexWorld_Thumb.png" type="image/png" />
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/02/27/world-hexes/</guid>
            </item>
        
            <item>
                <title>NZ Population Hexbins</title>
                <description>&lt;p&gt;I&amp;#39;ve been thinking a lot about hexbin maps lately, after an earlier
exploration of &lt;a href=&quot;/2015/01/16/auckland-employment-centres/&quot;&gt;employment centers&lt;/a&gt;.
In the previous map, I generated the hexbin with a QGIS plug-in and manually
fixed up coastal hexes in a very non-reproducible way.&lt;/p&gt;

&lt;p&gt;I since discovered that the &lt;a href=&quot;http://cartodb.com/&quot;&gt;CartoDB&lt;/a&gt; project have an open
repository of &lt;a href=&quot;https://github.com/CartoDB/cartodb-postgresql&quot;&gt;postgresql functions&lt;/a&gt;
which include functions for &lt;a href=&quot;https://github.com/CartoDB/cartodb-postgresql/blob/master/scripts-available/CDB_Hexagon.sql#L31&quot;&gt;generating hexagonal grids&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This makes it easy to create hexagonal grids in postgresql/postgis and automate the
process of creating land overlays for specific areas.&lt;/p&gt;

&lt;p&gt;First of all I grabbed the LINZ coastlines and islands polygon layer, simplified it considerably, removed some
of the smaller off-shore islands and loaded this into postgres as the table &lt;code&gt;land_cover&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I then created a hexagonal grid with a side length of 10km that covers the entire extent of the coastline layer:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ST_SetSRID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;CDB_HexagonGrid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ST_Extent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;&amp;quot;geom&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extent&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;land_cover&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;mi&quot;&gt;2193&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;hexgrid&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The next step is to remove the hexagons that don&amp;#39;t cover land. The follow query finds hexagons that
intersect with the land cover layer and contain at least 30% land. This factor is a somewhat arbitrary - 
I wanted it to be slightly optimistic about coverage:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hexgrid_cover&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hexgrid&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;land_cover&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ST_INTERSECTS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AND&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ST_AREA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ST_INTERSECTION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ST_AREA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(Note that since the area of each hexagon is constant, the &lt;code&gt;ST_AREA(a.geom)&lt;/code&gt; can be optimized out, but it&amp;#39;s
provided here for simplicity)&lt;/p&gt;

&lt;p&gt;The result is a hexagonal grid coverage for the country. I&amp;#39;ve uploaded a few nationwide hexbin sets I&amp;#39;ve generated
for the whole country as &lt;a href=&quot;https://github.com/hamishcampbell/nz-data/tree/master/hexbin&quot;&gt;geojson on GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For this particular map, I&amp;#39;ve taken the NZ meshblock data with &amp;#39;usually resident population&amp;#39; counts summed the totals
for the hexagonal intersections weighted by area. I won&amp;#39;t provide the detail here but:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Pre-calculate the area for each meshblock as a new column in the meshblock table.&lt;/li&gt;
&lt;li&gt;Create a new layer of &lt;a href=&quot;http://postgis.net/docs/ST_Intersection.html&quot;&gt;intersections&lt;/a&gt; between the meshblock layer and hexagons, including the hexagon ID, original meshblock area and population count.&lt;/li&gt;
&lt;li&gt;Calculate the new (sliced) meshblock area, and divide this by the original area to get the proportion.&lt;/li&gt;
&lt;li&gt;Multiply the proportional area by the original resident population count to get the weighted population.&lt;/li&gt;
&lt;li&gt;Sum the weighted population over each hexagon id and assign that to the relevant hexagon.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;Datasources&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://data.linz.govt.nz/layer/1153-nz-coastlines-and-islands-polygons-topo-150k/&quot;&gt;NZ Coastlines and Islands Polygons&lt;/a&gt; (LINZ)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.stats.govt.nz/browse_for_stats/people_and_communities/Geographic-areas/digital-boundary-files.aspx&quot;&gt;Statistics NZ Pattern Files&lt;/a&gt; (Statistics NZ)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://nzdotstat.stats.govt.nz/wbos/Index.aspx&quot;&gt;Statistics NZ Tables&lt;/a&gt; (Statistics NZ)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <pubDate>Fri, 20 Feb 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/02/20/nz-population-hexbin/</link>
                
                <enclosure url="http://polemic.nz/assets/maps/20150220-NZHexBinPop_Thumb.png" type="image/png" />
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/02/20/nz-population-hexbin/</guid>
            </item>
        
            <item>
                <title>Auckland Crash Animation</title>
                <description>&lt;p&gt;&lt;iframe src=&quot;//player.vimeo.com/video/118107645&quot; width=&quot;100%&quot; height=&quot;400&quot; frameborder=&quot;0&quot; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt; &lt;p&gt;&lt;a href=&quot;http://vimeo.com/118107645&quot;&gt;Auckland Central Crashes 2010-2014&lt;/a&gt; from &lt;a href=&quot;http://vimeo.com/user36859677&quot;&gt;Hamish Campbell&lt;/a&gt; on &lt;a href=&quot;https://vimeo.com&quot;&gt;Vimeo&lt;/a&gt;.&lt;/p&gt;&lt;/p&gt;

&lt;p&gt;The NZTA collects detailed crash data from the NZ Police. This data,
held in the NZ Crash Analysis System (CAS) is published regularly (&lt;a href=&quot;http://www.nzta.govt.nz/resources/crash-analysis-system-data/index.html&quot;&gt;here&lt;/a&gt; ) and
provides detailed data on the location, causes and consequences
of crashes on New Zealand roads.&lt;/p&gt;

&lt;p&gt;The above animation shows all central Auckland crashes over the period Jan 2010 to June 2014 (the latest available data). Fatalities are coded in dark red, severe injury crashes in orange, minor injury crashes in yellow and no-injury crashes in blue. The map is made with QGIS and the frames generated with the &lt;a href=&quot;https://plugins.qgis.org/plugins/timemanager/&quot;&gt;TimeManager&lt;/a&gt; plugin.&lt;/p&gt;

&lt;p&gt;This is a very simple view of the data. The tables contain lots of useful information, like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;The types of vehicles involved (as well as cyclists and pedestrians)&lt;/li&gt;
&lt;li&gt;Weather and lighting conditions&lt;/li&gt;
&lt;li&gt;Vehicle movement&lt;/li&gt;
&lt;li&gt;Characteristics of the road&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;What sorts of questions would you ask, given the above information?&lt;/p&gt;

&lt;h3&gt;Datasources&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.nzta.govt.nz/resources/crash-analysis-system-data/index.html&quot;&gt;CAS Crash Data 2000-2014&lt;/a&gt; (NZTA)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://data.linz.govt.nz&quot;&gt;Base data layers&lt;/a&gt; (LINZ)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <pubDate>Fri, 30 Jan 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/01/30/auckland-crashes-animation/</link>
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/01/30/auckland-crashes-animation/</guid>
            </item>
        
            <item>
                <title>Warbirds over Auckland</title>
                <description>&lt;p&gt;Warbirds over Auckland for the 175th anniversary celebrations. Happy Birthday, Auckland City!&lt;/p&gt;
</description>
                <pubDate>Tue, 27 Jan 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/01/27/warbirds/</link>
                
                
                <enclosure url="http://polemic.nz/assets/photos/20150125-Warbirds_Thumb.jpg" type="image/jpg" />
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/01/27/warbirds/</guid>
            </item>
        
            <item>
                <title>Electro-Punk</title>
                <description>&lt;p&gt;An ice-cream machine at The Tannery in New Lynn. A curious mix of modern and old.&lt;/p&gt;
</description>
                <pubDate>Sat, 24 Jan 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/01/24/electro-punk/</link>
                
                
                <enclosure url="http://polemic.nz/assets/photos/20150124-ElectroPunk_Thumb.jpg" type="image/jpg" />
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/01/24/electro-punk/</guid>
            </item>
        
            <item>
                <title>Auckland Suburbs - Part 1</title>
                <description>&lt;p&gt;So, suburbs. You&amp;#39;re probably looking at this map and
wondering &amp;quot;what&amp;#39;s the big deal?&amp;quot;. It&amp;#39;s a terrible
map of the suburbs of Auckland. There are lots of holes. Some
bits are downright inaccurate. And you&amp;#39;d be right to wonder. Then again, you might be someone who has once tried to acquire an authoritative, free and open dataset of suburbs
for Auckland (or, better yet, the whole of New Zealand).&lt;/p&gt;

&lt;p&gt;If you&amp;#39;re in the latter group, then you&amp;#39;re lucky enough to have experienced the strange
black hole of rationality that surrounds the &lt;a href=&quot;https://data.govt.nz/datasetrequest/show/4&quot;&gt;NZ Localities&lt;/a&gt; dataset held -
oddly enough - by the New Zealand Fire Service Commission. And if so, you probably have an idea of why the map above is significant.&lt;/p&gt;

&lt;p&gt;I&amp;#39;ll write a bit more about the Commission at a later date (the Commission is not be confused with the New Zealand Fire Service, mind. The Commission is the board that oversees the actual Fire Service, it pays to be pedantic when dealing with agencies and the OIA). It&amp;#39;s a cautionary tale for all open data advocates.&lt;/p&gt;

&lt;p&gt;So here we are: we want to know about suburbs, but we can&amp;#39;t use the official data. We&amp;#39;ll need to get it elsewhere. Fortunately there is another CC-BY dataset that &lt;em&gt;does&lt;/em&gt; have a &lt;code&gt;locality&lt;/code&gt; field that looks a lot like a suburb&lt;sup&gt;1&lt;/sup&gt;. This is the &lt;a href=&quot;https://data.linz.govt.nz/layer/779-nz-street-address-electoral/&quot;&gt;New Zealand Electoral Address&lt;/a&gt; dataset from LINZ:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;This layer provides all allocated addresses as advised to LINZ by Territorial Authorities (TAs). Under the Local Government Act 1974 (section 319) it is the responsibility of the TAs to advise LINZ (the Surveyor General) of all allocated addresses in their district.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;How do we go from the point layer to suburb polygons? I first tried calculating Concave Hulls over the locality but the results were.. not great. However the priority for LINZ is to correctly locate addresses within Stats NZ Meshblocks. So we can assign the address locality to the containing meshblock in Postgres, including a count of the times that locality name appears, like so (where I&amp;#39;ve already imported the Statistics Meshblocks as &lt;code&gt;meshblocks&lt;/code&gt; and address points as &lt;code&gt;electoral-addresses&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locality_count&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;meshblock-localities&amp;quot;&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;meshblocks&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mb&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INNER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;JOIN&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;electoral-addresses&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ad&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ST_Intersects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ST_SetSRID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2193&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ta2014_nam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Auckland&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locality&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locality_count&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DESC&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This new table &lt;code&gt;meshblock-localities&lt;/code&gt; now has duplicate meshblocks for each locality found, so we select distinct meshblocks by picking the most common locality found:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DISTINCT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locality_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;meshblock-localities-distinct&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;meshblock-localities&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locality_count&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DESC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, we still have individual meshblocks, but we really want to join localities together to form single polygons:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;locality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ST_UNION&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;meshblock-localities-union&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;meshblock-localities-distinct&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now our table &lt;code&gt;meshblock-localities-union&lt;/code&gt; has just the
locality name and it&amp;#39;s geometry. I&amp;#39;ve then imported it into
QGIS and performed some additional cleanup:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Split multi-part geometries. There are a lot of small
blocks that are geographically distinct with odd (sometimes hyphenated) names.&lt;/li&gt;
&lt;li&gt;Remove some spurious records, e.g. localities like &amp;quot;Auckland&amp;quot; - probably assigned to addresses that are not obviously in a well known suburb.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The result: a rough starting point to build a proper 
suburb dataset, from CC-BY licensed data sources.&lt;/p&gt;

&lt;h3&gt;Datasources&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://data.linz.govt.nz/layer/779-nz-street-address-electoral/&quot;&gt;New Zealand Electoral Address&lt;/a&gt; (Land Information New Zealand)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.stats.govt.nz/browse_for_stats/people_and_communities/Geographic-areas/digital-boundary-files.aspx&quot;&gt;New Zealand 2014 Clipped Meshblock Boundaries&lt;/a&gt; (Statistics NZ)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Footnotes&lt;/h3&gt;

&lt;p&gt;&lt;sup&gt;1.&lt;/sup&gt; It turns out that the &lt;code&gt;locality&lt;/code&gt; field is indeed, slightly indirectly, from the NZFS locality boundaries. More on that in Part 2.&lt;/p&gt;
</description>
                <pubDate>Fri, 23 Jan 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/01/23/auckland-suburbs-part-1/</link>
                
                <enclosure url="http://polemic.nz/assets/maps/20150123-Auckland-Suburbs_Thumb.png" type="image/png" />
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/01/23/auckland-suburbs-part-1/</guid>
            </item>
        
            <item>
                <title>Popular New Zealand Road Names</title>
                <description>&lt;p&gt;I pulled down Land Information New Zealand&amp;#39;s &lt;a href=&quot;https://data.linz.govt.nz/layer/818-nz-road-centre-line-electoral/&quot;&gt;Road Centre Line dataset&lt;/a&gt;
to have quick look at name statistics. To analyse the data, import it to Postgres with &lt;a href=&quot;http://postgis.net/docs/manual-2.0/using_postgis_dbmanagement.html#shp2pgsql_usage&quot;&gt;&lt;code&gt;shp2pgsql&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Download the data in the Shapefile format&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Extract and load into an existing Postgresql/PostGIS database:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;shp2pgsql nz-road-centre-line-electoral.shp | psql [database_name]&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Now you can run queries against the data. To get the 50 most popular road names with their total length:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; 
    &lt;span class=&quot;ss&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ROUND&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SUM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ST_LENGTH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total_length&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;nz-road-centre-line-electoral&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total_count&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DESC&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;LIMIT&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And the results:&lt;/p&gt;

&lt;table style=&quot;width: 100%;&quot;&gt;
&lt;thead&gt;
    &lt;tr&gt;
        &lt;th&gt;Rank&lt;/th&gt;
        &lt;th&gt;Name&lt;/th&gt;
        &lt;th&gt;Frequency&lt;/th&gt;
        &lt;th&gt;Length (m)&lt;/th&gt;
    &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;Accessway&lt;/td&gt;&lt;td&gt;2414&lt;/td&gt;&lt;td&gt;220,876&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;&lt;td&gt;Service Lane&lt;/td&gt;&lt;td&gt;492&lt;/td&gt;&lt;td&gt;54,500&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;&lt;td&gt;Roadway&lt;/td&gt;&lt;td&gt;452&lt;/td&gt;&lt;td&gt;335,172&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;4&lt;/td&gt;&lt;td&gt;State Highway  1&lt;/td&gt;&lt;td&gt;125&lt;/td&gt;&lt;td&gt;2,168,214&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;5&lt;/td&gt;&lt;td&gt;George Street&lt;/td&gt;&lt;td&gt;74&lt;/td&gt;&lt;td&gt;38,105&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;6&lt;/td&gt;&lt;td&gt;Queen Street&lt;/td&gt;&lt;td&gt;69&lt;/td&gt;&lt;td&gt;50,181&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;7&lt;/td&gt;&lt;td&gt;Beach Road&lt;/td&gt;&lt;td&gt;69&lt;/td&gt;&lt;td&gt;103,280&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;8&lt;/td&gt;&lt;td&gt;High Street&lt;/td&gt;&lt;td&gt;68&lt;/td&gt;&lt;td&gt;68,671&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;King Street&lt;/td&gt;&lt;td&gt;66&lt;/td&gt;&lt;td&gt;42,302&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;Station Road&lt;/td&gt;&lt;td&gt;66&lt;/td&gt;&lt;td&gt;80,138&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;11&lt;/td&gt;&lt;td&gt;Rata Street&lt;/td&gt;&lt;td&gt;57&lt;/td&gt;&lt;td&gt;25,589&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;12&lt;/td&gt;&lt;td&gt;School Road&lt;/td&gt;&lt;td&gt;55&lt;/td&gt;&lt;td&gt;75,847&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;13&lt;/td&gt;&lt;td&gt;Grey Street&lt;/td&gt;&lt;td&gt;54&lt;/td&gt;&lt;td&gt;36,090&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;14&lt;/td&gt;&lt;td&gt;State Highway  2&lt;/td&gt;&lt;td&gt;52&lt;/td&gt;&lt;td&gt;991,692&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;15&lt;/td&gt;&lt;td&gt;Church Street&lt;/td&gt;&lt;td&gt;52&lt;/td&gt;&lt;td&gt;40,540&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;16&lt;/td&gt;&lt;td&gt;Elizabeth Street&lt;/td&gt;&lt;td&gt;52&lt;/td&gt;&lt;td&gt;21,323&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;17&lt;/td&gt;&lt;td&gt;Victoria Street&lt;/td&gt;&lt;td&gt;50&lt;/td&gt;&lt;td&gt;45,263&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;18&lt;/td&gt;&lt;td&gt;Rimu Street&lt;/td&gt;&lt;td&gt;48&lt;/td&gt;&lt;td&gt;17,075&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;19&lt;/td&gt;&lt;td&gt;River Road&lt;/td&gt;&lt;td&gt;48&lt;/td&gt;&lt;td&gt;273,968&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;20&lt;/td&gt;&lt;td&gt;Bridge Street&lt;/td&gt;&lt;td&gt;46&lt;/td&gt;&lt;td&gt;30,604&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;21&lt;/td&gt;&lt;td&gt;State Highway  6&lt;/td&gt;&lt;td&gt;46&lt;/td&gt;&lt;td&gt;1,183,521&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;22&lt;/td&gt;&lt;td&gt;Cemetery Road&lt;/td&gt;&lt;td&gt;46&lt;/td&gt;&lt;td&gt;56,800&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;23&lt;/td&gt;&lt;td&gt;Main Road&lt;/td&gt;&lt;td&gt;45&lt;/td&gt;&lt;td&gt;85,202&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;24&lt;/td&gt;&lt;td&gt;Albert Street&lt;/td&gt;&lt;td&gt;44&lt;/td&gt;&lt;td&gt;25,832&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;25&lt;/td&gt;&lt;td&gt;Domain Road&lt;/td&gt;&lt;td&gt;44&lt;/td&gt;&lt;td&gt;47,879&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;26&lt;/td&gt;&lt;td&gt;Mill Road&lt;/td&gt;&lt;td&gt;43&lt;/td&gt;&lt;td&gt;111,434&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;27&lt;/td&gt;&lt;td&gt;Short Street&lt;/td&gt;&lt;td&gt;43&lt;/td&gt;&lt;td&gt;6,575&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;28&lt;/td&gt;&lt;td&gt;Boundary Road&lt;/td&gt;&lt;td&gt;42&lt;/td&gt;&lt;td&gt;152,026&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;29&lt;/td&gt;&lt;td&gt;Miro Street&lt;/td&gt;&lt;td&gt;42&lt;/td&gt;&lt;td&gt;17,852&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;30&lt;/td&gt;&lt;td&gt;William Street&lt;/td&gt;&lt;td&gt;41&lt;/td&gt;&lt;td&gt;17,808&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;31&lt;/td&gt;&lt;td&gt;Matai Street&lt;/td&gt;&lt;td&gt;40&lt;/td&gt;&lt;td&gt;15,183&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;Totara Street&lt;/td&gt;&lt;td&gt;40&lt;/td&gt;&lt;td&gt;18,546&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;33&lt;/td&gt;&lt;td&gt;Wilson Road&lt;/td&gt;&lt;td&gt;39&lt;/td&gt;&lt;td&gt;104,471&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;34&lt;/td&gt;&lt;td&gt;Seddon Street&lt;/td&gt;&lt;td&gt;38&lt;/td&gt;&lt;td&gt;25,237&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;John Street&lt;/td&gt;&lt;td&gt;37&lt;/td&gt;&lt;td&gt;14,036&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;36&lt;/td&gt;&lt;td&gt;Princes Street&lt;/td&gt;&lt;td&gt;36&lt;/td&gt;&lt;td&gt;26,509&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;37&lt;/td&gt;&lt;td&gt;Charles Street&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;16,041&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;38&lt;/td&gt;&lt;td&gt;Oxford Street&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;23,789&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;39&lt;/td&gt;&lt;td&gt;Nelson Street&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;17,365&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;40&lt;/td&gt;&lt;td&gt;James Street&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;15,162&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;41&lt;/td&gt;&lt;td&gt;Valley Road&lt;/td&gt;&lt;td&gt;34&lt;/td&gt;&lt;td&gt;92,760&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;42&lt;/td&gt;&lt;td&gt;York Street&lt;/td&gt;&lt;td&gt;34&lt;/td&gt;&lt;td&gt;12,786&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;43&lt;/td&gt;&lt;td&gt;Tui Street&lt;/td&gt;&lt;td&gt;34&lt;/td&gt;&lt;td&gt;12,064&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;44&lt;/td&gt;&lt;td&gt;Kowhai Street&lt;/td&gt;&lt;td&gt;34&lt;/td&gt;&lt;td&gt;12,220&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;45&lt;/td&gt;&lt;td&gt;Campbell Street&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;17,273&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;46&lt;/td&gt;&lt;td&gt;Kent Street&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;18,598&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;Ward Street&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;17,431&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;48&lt;/td&gt;&lt;td&gt;Russell Street&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;14,733&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;49&lt;/td&gt;&lt;td&gt;Duke Street&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;17,436&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;50&lt;/td&gt;&lt;td&gt;Main Street&lt;/td&gt;&lt;td&gt;32&lt;/td&gt;&lt;td&gt;33,201&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;Short Street - clearly well named at an average length of 153m.&lt;/p&gt;

&lt;p&gt;And of course we can get the total length of all road centrelines in the dataset with:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;SUM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ST_LENGTH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;geom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total_length&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;&amp;quot;nz-road-centre-line-electoral&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Which gives 123,086,930 metres of road.*&lt;/p&gt;

&lt;p&gt;*&lt;small&gt;Note that the dataset exists for electoral addressing purposes, so this comment on the layer
information is important: &lt;q&gt;Because some roads have multiple names for part of their lengths, some road centreline geometries will duplicate parts of other roads even though there is in reality only one road formation.&lt;/q&gt; In other words, we&amp;#39;ve got some duplication above.
&lt;/small&gt;&lt;/p&gt;
</description>
                <pubDate>Mon, 19 Jan 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/01/19/popular-nz-road-names/</link>
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/01/19/popular-nz-road-names/</guid>
            </item>
        
            <item>
                <title>Auckland Employment Centres</title>
                <description>&lt;p&gt;A recent &lt;a href=&quot;http://transportblog.co.nz&quot;&gt;Auckland Transport Blog&lt;/a&gt; &lt;a href=&quot;http://transportblog.co.nz/2015/01/13/the-geometry-of-urban-labour-markets/&quot;&gt;post&lt;/a&gt; highlighted one of my
biggest bugbears about misleading cartography - using fill
symbology from absolute values that are dependant on the area
of the underlying polygons. It seemed like as good excuse as any to try out
hexbinning as an alternative method of looking at the data.&lt;/p&gt;

&lt;p&gt;The analysis in the post looked at the &amp;quot;&lt;a href=&quot;http://transportblog.co.nz/2015/01/13/the-geometry-of-urban-labour-markets/&quot;&gt;Geometry of Urban Labour Markets&lt;/a&gt;&amp;quot; and is seeks to find patterns of employment
as it relates to transport in the city. Here is the original map:&lt;/p&gt;

&lt;div style='text-align: center'&gt;
    &lt;img src='http://transportblog.co.nz/wp-content/uploads/2014/11/Auckland_employment_by_AU_2014-1024x724.jpg' style=&quot;min-width: 300px; border: 1px solid #DDD; width: 80%&quot; /&gt;
    &lt;p&gt;&lt;small&gt;Employee count by Auckland area unit, 2014 - &lt;a href=&quot;http://transportblog.co.nz/2015/01/13/the-geometry-of-urban-labour-markets/&quot; target=&quot;_blank&quot;&gt;Auckland Transport Blog&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;The data is based on Statistics New Zealand employee count estimates for census area unit (AU).
The problem is that the size of an area unit is roughly proportional to normally &lt;em&gt;resident&lt;/em&gt; 
population. So what happens if we provide the light to dark symbology in this map? Well it looks
like Mangere South (the dark blue block to the south) is the biggest employment centre in the city, with other the other most significant areas outside of the CBD in industrial areas like Otahuhu and East Tamaki.&lt;/p&gt;

&lt;p&gt;Is that true? It&amp;#39;s not surprising that a lot of people work in those areas - they&amp;#39;re large areas of industrial land. Mangere South includes the Airport and its environs. The problem is the data is skewed: few people actually live there, so the AU is particularly large. Practically speaking it means that industrial areas will appear more significant (a square-ish relation) than other areas of high employment with larger resident populations (e.g. the CBD and regional centres, commercial and mixed areas). &lt;/p&gt;

&lt;p&gt;If you&amp;#39;re talking about transport and planning, this is a pretty important distinction.&lt;/p&gt;

&lt;p&gt;If you want to compare absolute values between variable geographic sizes, you need to look
at density. Fortunately this is easy in most GIS packages - just add a new field and fill
it with the absolute value divided by the calculated area of the block.&lt;/p&gt;

&lt;p&gt;In QGIS you can go the the attribute table, enable layer editing, hit the field calculator and add
a new calculated field with the formula &lt;code&gt;&amp;quot;value_field&amp;quot; / $area&lt;/code&gt;. Symbolize with gradients based on
the density value and you have an easy way to compare AUs of different sizes.&lt;/p&gt;

&lt;p&gt;But density might not be the easiest way to visualise the data or to start clustering areas to
find patterns. This is where hexbinning - aggregated values over a regular grid of hexagons - comes in.&lt;/p&gt;

&lt;p&gt;In this map, I&amp;#39;ve created a hexbin layer using the handy &lt;a href=&quot;http://plugins.qgis.org/plugins/mmqgis/&quot;&gt;MMQGIS plugin&lt;/a&gt;. After calculating the employee density for the AUs, I&amp;#39;ve mapped the mean
values to the hexes, and highlighted the hexes to show where the most dense employment areas
in Auckland exist. The top 20% by density are highlighted, with a roughly logarithmic scale for the top 20% from light to dark. &lt;/p&gt;

&lt;p&gt;Now you can start to see where the centres of employment exist, and what those centres look like. The CBD is - by far - the biggest centre of employment in the region, but an awful lot of people work close to the CBD. The surrounding suburbs are not-insignificant employment regions in their own right. Rosebank, New Lynn, Henderson, Takapuna and Albany show characteristics of a composite model of development, and to the industry south-east we see a far more dispersed pattern.&lt;/p&gt;

&lt;p&gt;Unfortunately there is one significant issue with my approach: the resolution of the hexes is significantly higher that of the original AUs in some areas. This is highlighted by the missing expected zone of employment around the Airport. While the map reveals the Mangere South AU
is actually (in aggregate) a region of low employment density, we also know that employment
there is actually considerably more concentrated &lt;em&gt;within&lt;/em&gt; the AU than the map implies.&lt;/p&gt;

&lt;p&gt;It means the Statistics NZ data is, in my opinion, inappropriately aggregated. We simply can&amp;#39;t pull fine-grained information about employment patterns in places where very few people live (but many people work). If you have suggestions on how that situation could be improved, leave a comment below!&lt;/p&gt;
</description>
                <pubDate>Fri, 16 Jan 2015 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2015/01/16/auckland-employment-centres/</link>
                
                <enclosure url="http://polemic.nz/assets/maps/20150116-Auckland_Employment_Centres2014_Thumb.png" type="image/png" />
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2015/01/16/auckland-employment-centres/</guid>
            </item>
        
            <item>
                <title>Kiwicon 8</title>
                <description>&lt;p&gt;Today&amp;#39;s map is a small tribute to Kiwicon 8 - New Zealand&amp;#39;s hacker conference
that I&amp;#39;m currently attending. The theme this year is &amp;quot;It&amp;#39;s always 1989 in computer
security&amp;quot;. It&amp;#39;s been an excellent conference so far and the cr√ºe have put on an amazing
show (a real life Delorean, for one!).&lt;/p&gt;

&lt;p&gt;Aside from the usual hacks and cracks, it&amp;#39;s been interesting to see some themes
emerge - for example - a shift from the &amp;#39;apparatus of security&amp;#39; to
the security of people and their (non-technological) networks.&lt;/p&gt;

&lt;p&gt;On to the map!&lt;/p&gt;

&lt;p&gt;To create the New Zealand outline I first generated a regular 50 km point grid as a snapping guide.
Then, with a new shapefile layer, I set the snapping options to 50,000 metres and started drawing. Creating
the features is just a matter of getting a rough outline and tweaking until it looks visually appealing. The
neon outline is a series of outline line symbolizers. The map is then exported to GIMP to add the text effects.
The latest version of QGIS has some great improvements, but the print composer is still very limited when
it comes to adding other elements.&lt;/p&gt;
</description>
                <pubDate>Fri, 12 Dec 2014 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2014/12/12/kiwicon-8/</link>
                
                <enclosure url="http://polemic.nz/assets/maps/20141212_Kiwicon_Thumb.png" type="image/png" />
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2014/12/12/kiwicon-8/</guid>
            </item>
        
            <item>
                <title>Population Proportional Meshblocks</title>
                <description>&lt;p&gt;My &lt;a href=&quot;/2014/11/28/nz-deprivation-index/&quot;&gt;last map&lt;/a&gt; visualised the NZ deprivation index by meshblock. It provided
a quick regional overview of deprivation however it obscures the
effects of population density. This week I wanted to explore different
ways to present the NZ meshblock dataset that emphasises population
distribution over geographic location.&lt;/p&gt;

&lt;p&gt;This map is the result of using a modified meshblock dataset I created with the
same deprivation data. The size of each block accurately reflects the
size of the population, and the position of the block is weighted to the
mean location of the population horizontally.&lt;/p&gt;

&lt;p&gt;Each &amp;#39;row&amp;#39; above contains all meshblocks quantized in to 10km bands (north/south)
with a width of 1 metre for each &amp;#39;population resident&amp;#39;. The grid is 50km square, so
a band that is one square wide represents 50,000 people, and a full grid square would
represent 250,000 people.&lt;/p&gt;

&lt;p&gt;This is an interesting way to arrange the meshblock set. It works
reasonably well for New Zealand where the country is roughly north/south
aligned, giving an idea of how the population is distributed and retaining
useful reference points for comparison. The blocks are a bit small, a problem
that is difficult to fix given the uneven population distribution.&lt;/p&gt;

&lt;h3&gt;Downloads&lt;/h3&gt;

&lt;p&gt;You can explore and download the modified meshblock layer I created for this map here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://labs.koordinates.com/layer/7344-population-weighted-meshblocks/&quot;&gt;Population Weighted Meshblocks&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Datasources&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.stats.govt.nz/browse_for_stats/people_and_communities/Geographic-areas/digital-boundary-files.aspx&quot;&gt;New Zealand 2013 Clipped Meshblock Boundaries&lt;/a&gt; (Statistics NZ)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.otago.ac.nz/wellington/departments/publichealth/research/hirp/otago020194.html&quot;&gt;NZDep2013 Meshblock Data&lt;/a&gt; (University of Otago)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <pubDate>Fri, 05 Dec 2014 00:00:00 +1300</pubDate>
                <link>http://polemic.nz/2014/12/05/population-proportional-meshblocks/</link>
                
                <enclosure url="http://polemic.nz/assets/maps/20141205-Deprivation-Revisited_Thumb.png" type="image/png" />
                
                
                
                <guid isPermaLink="true">http://polemic.nz/2014/12/05/population-proportional-meshblocks/</guid>
            </item>
        
    </channel>
</rss>